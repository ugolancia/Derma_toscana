setwdsetwd("~/Desktop/pharmaceutical business/Rheuma/Derma")
library(xlsx)
psor<- read.xlsx("DB_derma_eng.xlsx", 1, stringsAsFactors = FALSE)
names(psor)[18]<- "arthritis"
names(psor)[4]<- "age"
setwd("~/Desktop/pharmaceutical business/Rheuma/Derma")
psor<- read.xlsx("DB_derma_eng.xlsx", 1, stringsAsFactors = FALSE)
names(psor)[18]<- "arthritis"
names(psor)[4]<- "age"
library(ggplot2)
jpg("fig_1.jpg", width = 529, height = 305, res = 600)
ggplot(psor, aes(x=arthritis, y=age, fill = arthritis)) + geom_boxplot() + ggtitle("Figure 1. Age in groups without and with arthritis")
png("fig_1.jpg", width = 529, height = 305, res = 600)
ggplot(psor, aes(x=arthritis, y=age, fill = arthritis)) + geom_boxplot() + ggtitle("Figure 1. Age in groups without and with arthritis")
png("fig_1.jpg", width = 529, height = 305, res = 600)
ggplot(psor, aes(x=arthritis, y=age, fill = arthritis)) + geom_boxplot() + ggtitle("Figure 1. Age in groups without and with arthritis")
dev.off()
png("fig_1.jpg", width = 5.3, height = 3, units = "inch", res = 600)
ggplot(psor, aes(x=arthritis, y=age, fill = arthritis)) + geom_boxplot() + ggtitle("Figure 1. Age in groups without and with arthritis")
dev.off()
ggplot(psor, aes(x=arthritis, y=age, fill = arthritis)) + geom_boxplot() + ggtitle("Figure 1. Age in groups without and with arthritis")
dev.copy(jpeg, "figure 1.jpeg", quality=300, width = 529, height=305)
dev.off()
library(ggplot2)
ggplot(psor, aes(x=arthritis, y=age, fill = arthritis)) + geom_boxplot() + ggtitle("Figure 1. Age in groups without and with arthritis")
dev.copy(jpeg, "figure 1.jpg", quality=300, width = 529, height=305)
dev.off()
ggplot(psor, aes(x=arthritis, y=age, fill = arthritis)) + geom_boxplot() + ggtitle("Figure 1. Age in groups without and with arthritis")
setwd("~/Desktop/Github/Derma_toscana/2016_02_03_Revisione/Code")
setwd("~/Desktop/Github/Derma_toscana/2016_02_03_Revisione/Code")
library(xlsx)
psor<- read.xlsx("DB_derma_eng.xlsx", 1, stringsAsFactors = FALSE)
names(psor)[18]<- "arthritis"
names(psor)[4]<- "age"
library(ggplot2)
ggplot(psor, aes(x=arthritis, y=age, fill = arthritis)) + geom_boxplot() + ggtitle("Figure 1. Age in groups without and with arthritis")
dev.copy(jpeg, "figure_1.jpg", quality=300, width = 529, height=305)
dev.off()
g<- ggplot(psor, aes(x=arthritis, y=age, fill = arthritis))
g + geom_boxplot() + ggtitle("Figure 1. Age in groups without and with arthritis")
setwd("~/Desktop/Github/Derma_toscana/2016_02_03_Revisione/Code")
library(xlsx)
psor<- read.xlsx("DB_derma_eng.xlsx", 1, stringsAsFactors = FALSE)
names(psor)[18]<- "arthritis"
names(psor)[4]<- "age"
library(ggplot2)
g<- ggplot(psor, aes(x=arthritis, y=age, fill = arthritis)) + geom_boxplot() + ggtitle("Figure 1. Age in groups without and with arthritis")
g
dev.copy(jpeg, "fig_1.jpg", quality=300, width = 529, height=305)
dev.off()
png("fig_1_bis.jpg", width = 8.5, height = 11, units = 'in', res = 600)
g<- ggplot(psor, aes(x=arthritis, y=age, fill = arthritis)) + geom_boxplot() + ggtitle("Figure 1. Age in groups without and with arthritis")
g
dev.off()
png("fig_1_bis.jpg", width = 6, height = 8, units = 'in', res = 600)
g<- ggplot(psor, aes(x=arthritis, y=age, fill = arthritis)) + geom_boxplot() + ggtitle("Figure 1. Age in groups without and with arthritis")
g
dev.off()
png("fig_1_bis.jpg", width = 6, height = 6, units = 'in', res = 600)
g<- ggplot(psor, aes(x=arthritis, y=age, fill = arthritis)) + geom_boxplot() + ggtitle("Figure 1. Age in groups without and with arthritis")
g
dev.off()
setwd("~/Desktop/Github/Derma_toscana/2016_02_03_Revisione/Code")
library(xlsx)
psor<- read.xlsx("DB_derma_eng.xlsx", 1, stringsAsFactors = FALSE)
names(psor)[18]<- "arthritis"
names(psor)[4]<- "age"
library(ggplot2)
g<- ggplot(psor, aes(x=arthritis, y=age, fill = arthritis)) + geom_boxplot() + ggtitle("Figure 1. Age in groups without and with arthritis")
g
png("fig_1_bis.jpg", width = 6, height = 6, units = 'in', res = 600)
g<- ggplot(psor, aes(x=arthritis, y=age, fill = arthritis)) + geom_boxplot() + ggtitle("Figure 1. Age in groups without and with arthritis")
g
dev.off()
t.test(age~arthritis, data = psor)
chisq.test(table(psor[, 13], psor[, 18]))
mosaicplot(table(psor[, 13], psor[, 18]), main = "Figure 2. Presence of arthritis (horizontal)
and of ungueal psoriasis (vertical)", col = c("red", "green"))
chisq.test(table(psor[, 13], psor[, 18]))
table(psor[, 13], psor[, 18])
mosaicplot(table(psor[, 16], psor[, 18]), main = "Figure 3. Arthritis diagnosis (horizontal) and
psoriasis on more than 50 % of body (vertical)", col = c("red", "green"))
chisq.test(table(psor[, 16], psor[, 18]))
names(psor)
98-24
x<- c(17, 13, 74)
m<- matrix(x, 2, 2)
chisq.test(m)
x<- c(17, 13, 24, 74)
m<- matrix(x, 2, 2)
chisq.test(m)
psorart<- subset(psor, psor$arthritis == "YES")
table(psorart[, 7])
names(psorart)
dia_art<- psorart[, 19]
dia_psor<- psorart[, 6]
time_lapse<- dia_art-dia_psor
time<- time_lapse[!is.na(time_lapse)]
time<- as.data.frame(time)
ggplot(time, aes(x = factor(0), y = time)) + geom_boxplot() + xlab("")+ scale_x_discrete(breaks = NULL) + coord_flip() + ggtitle("Figure 4. Time between diagnosis of psoriasis and of arthritis (years)")
time_lapse<- dia_art-dia_psor
time<- time_lapse[!is.na(time_lapse)]
time<- as.data.frame(time)
png("fig_2.jpg", width = 6, height = 4, units = 'in', res = 600)
ggplot(time, aes(x = factor(0), y = time)) + geom_boxplot() + xlab("")+ scale_x_discrete(breaks = NULL) + coord_flip() + ggtitle("Figure 2. Time between diagnosis of psoriasis and of arthritis (years)")
dev.off()
png("fig_2.jpg", width = 6, height = 4, units = 'in', res = 600)
ggplot(time, aes(x = factor(0), y = time)) + geom_boxplot() + xlab("")+ scale_x_discrete(breaks = NULL) + coord_flip() + ggtitle("Figure 2. Time between diagnosis of psoriasis and of arthritis (years)", cex=0.8)
dev.off()
png("fig_2.jpg", width = 6, height = 4, units = 'in', res = 600)
ggplot(time, aes(x = factor(0), y = time)) + geom_boxplot(fill = "red") + xlab("")+ scale_x_discrete(breaks = NULL) + coord_flip() + ggtitle("Figure 2. Time between diagnosis of psoriasis and of arthritis (years)")
dev.off()
png("fig_2.jpg", width = 6, height = 4, units = 'in', res = 600)
ggplot(time, aes(x = factor(0), y = time)) + geom_boxplot(fill = "red") + xlab("")+ scale_x_discrete(breaks = NULL) + coord_flip() + ggtitle("Figure 2. Time between diagnosis of psoriasis and of arthritis (years)", size = 5)
dev.off()
png("fig_2.jpg", width = 6, height = 4, units = 'in', res = 600)
ggplot(time, aes(x = factor(0), y = time)) + geom_boxplot(fill = "red") + xlab("")+ scale_x_discrete(breaks = NULL) + coord_flip() + ggtitle("Figure 2. Time between diagnosis of psoriasis and of arthritis (years)") + theme(
plot.title = element_text(color="red", size=7)
dev.off()
png("fig_2.jpg", width = 6, height = 4, units = 'in', res = 600)
ggplot(time, aes(x = factor(0), y = time)) + geom_boxplot(fill = "red") + xlab("") + scale_x_discrete(breaks = NULL) + coord_flip() + ggtitle("Figure 2. Time between diagnosis of psoriasis and of arthritis (years)") + theme(
plot.title = element_text(size=7))
dev.off()
png("fig_2.jpg", width = 6, height = 4, units = 'in', res = 600)
ggplot(time, aes(x = factor(0), y = time)) + geom_boxplot(fill = "red") + xlab("") + scale_x_discrete(breaks = NULL) + coord_flip() + ggtitle("Figure 2. Time between diagnosis of psoriasis and of arthritis (years)") + theme(
plot.title = element_text(size=10))
dev.off()
psor<- psor[ , 1:26]
names(psor)
summary(psor$PASI)
#obviously there is a mistake because 90 is not possible as a score
psor$PASI[psor$PASI>50] <- NA
psor$arthritis[psor$arthritis == "YES"]<- 1
psor$arthritis[psor$arthritis == "NOT"]<- 0
boxplot(psor$PASI~psor$arthritis)
table(psor$PASI, psor$arthritis)
table(sum(psor$PASI), psor$arthritis)
summary(psor$PASI)
summary(psor$PASI~psor$arthritis)
t.test(psor$PASI~psor$arthritis)
fit<- glm(arthritis~PASI, data = psor, family = binomial())
plot(fit)
psor[, 18]
psor<- read.xlsx("DB_derma_eng.xlsx", 1, stringsAsFactors = FALSE)
names(psor)[18]<- "arthritis"
names(psor)[4]<- "age"
summary(psor$PASI)
psor$PASI[psor$PASI>50] <- NA
summary(psor$PASI)
psor[, 18]
table(is.na(psor$PASI), psor$arthritis)
boxplot(psor$PASI~psor$arthritis)
t.test(psor$PASI~psor$arthritis)
39/(39+63)
13/(13+19)
wilcox.test(psor$PASI~psor$arthritis)
psorartno<- subset(psor, psor$artrite == "NOT")
psorartno<- subset(psor, psor$arthritis == "NOT")
hist(psorartno$PASI)
hist(log(psorartno$PASI))
hist(log(psorartno$PASI+0.1))
hist(log(psorartno$PASI))
hist(psorartno$PASI)
